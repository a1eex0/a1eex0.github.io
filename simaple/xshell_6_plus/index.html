<!DOCTYPE html>
<html lang="zh-cn">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="Xshell_6_plus">
<meta itemprop="description" content="Xshell 6 plus 下载 官网下载 左边是需要输入注册码的，右边是30天的评估版，随意填写，使用临时邮箱就可以接收下载链接了，产品的下载链接路径是一样的，不同"><meta itemprop="datePublished" content="2020-12-28T14:08:52&#43;08:00" />
<meta itemprop="dateModified" content="2020-12-28T14:08:52&#43;08:00" />
<meta itemprop="wordCount" content="1637"><meta itemprop="image" content="https://www.a1ee.cn/bg.png">
<meta itemprop="keywords" content="crack," /><meta property="og:title" content="Xshell_6_plus" />
<meta property="og:description" content="Xshell 6 plus 下载 官网下载 左边是需要输入注册码的，右边是30天的评估版，随意填写，使用临时邮箱就可以接收下载链接了，产品的下载链接路径是一样的，不同" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.a1ee.cn/simaple/xshell_6_plus/" /><meta property="og:image" content="https://www.a1ee.cn/bg.png" /><meta property="article:section" content="simaple" />
<meta property="article:published_time" content="2020-12-28T14:08:52&#43;08:00" />
<meta property="article:modified_time" content="2020-12-28T14:08:52&#43;08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.a1ee.cn/bg.png"/>

<meta name="twitter:title" content="Xshell_6_plus"/>
<meta name="twitter:description" content="Xshell 6 plus 下载 官网下载 左边是需要输入注册码的，右边是30天的评估版，随意填写，使用临时邮箱就可以接收下载链接了，产品的下载链接路径是一样的，不同"/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Xshell_6_plus</title>
	<link rel="stylesheet" href="https://www.a1ee.cn/css/style.min.eac77496566fd7d5768fd650ddb0b2b181ca6a2d7c5fdd6fe6b8ba4bf47e566f.css" integrity="sha256-6sd0llZv19V2j9ZQ3bCysYHKai18X91v5ri6S/R+Vm8=" crossorigin="anonymous">
	<style>.bg-img {background-image: url('https://www.a1ee.cn/bg.png');}</style>
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.a1ee.cn">alee</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://www.a1ee.cn/basic/">BASIC</a>
				<a href="https://www.a1ee.cn/simaple/">SIMAPLE</a>
				<a href="https://www.a1ee.cn/medium/">MEDIUM</a>
				<a href="https://www.a1ee.cn/about-me/">ABOUT</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="img-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></button><span class="hdr-social hide-in-mobile"><a href="https://github.com/a1eex0" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.a1ee.cn/basic/">BASIC</a></li>
			<li><a href="https://www.a1ee.cn/simaple/">SIMAPLE</a></li>
			<li><a href="https://www.a1ee.cn/medium/">MEDIUM</a></li>
			<li><a href="https://www.a1ee.cn/about-me/">ABOUT</a></li>
		</ul>
	</div>


	<div class="bg-img"></div>
	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Dec 28, 2020</span></div>
				<h1>Xshell_6_plus</h1>
			</header>
			<div class="content">
				<h1 id="xshell-6-plus">Xshell 6 plus<a href="#xshell-6-plus" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<h2 id="下载">下载<a href="#下载" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p><a href="https://www.netsarang.com/en/xshell-plus-download/">官网下载</a></p>
<p><img src="/xshell6_images/20200410101322924_26133.png" alt=""></p>
<p>左边是需要输入注册码的，右边是30天的评估版，随意填写，使用临时邮箱就可以接收下载链接了，产品的下载链接路径是一样的，不同版本的xshell在于最后面附加标号（r、p）：</p>
<pre><code>https://cdn.netsarang.net/30486508/Xshell-6.0.0193r.exe    plus版本
https://cdn.netsarang.net/30486508/Xshell-6.0.0193.exe    评估版本
https://cdn.netsarang.net/30486508/Xshell-6.0.0193p.exe    教育版
</code></pre><p>这次针对的是plus版本的分析。</p>
<h2 id="分析">分析<a href="#分析" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>安装xshell，plus版本需要输入注册码才会安装，这里并没有计算注册码是否过期，主要是提取注册码的时间和一些其他标识信息。注册码只要是真是注册码即可，所以可以随意百度一个来使用，区别就是标识会有所不同，不影响功能正常使用。我就偷懒用了百度的第一个 <code>180807-116568-999990</code> 。
输入序列号，进入下一步</p>
<p><img src="/xshell6_images/20200410102723036_9387.png" alt="">
如果不输入序列号是不让你进行下一步的，也就无法安装了，这里我就用默认安装路径了，也可以自行修改一下。</p>
<p><img src="/xshell6_images/20200410102826402_26182.png" alt=""></p>
<p>安装完成后，应该是这样的，如果你以前安装过的话。如果是第一次安装，运行一次后，关闭再运行即可，主要是触发本地校验程序，校验你的序列号为过期并提示你<strong>未激活</strong></p>
<p><img src="/xshell6_images/20200410103812761_11155.png" alt=""></p>
<p>这里的 <code>License Type</code> 、<code>Number of License</code> 、<code>Issue Date</code> 是根据序列号来的标识，所以使用不同的序列号，会呈现不一样的数据，目前没发现有啥影响的。</p>
<p>从<code>License Type</code>后边的 <code>(Not Activated)</code>入手，用x32dbg调试（这是一个32位程序）<code>xshell.exe</code></p>
<p><img src="/xshell6_images/20200410104759750_30397.png" alt=""></p>
<p>在反汇编窗口查看上下文代码，得知是从上面的je跳转过来的，我们往上找到函数入口，下个断点，方便一会儿观察上下文。</p>
<p><img src="/xshell6_images/20200410104939324_22462.png" alt=""></p>
<p>点击关于触发断点，往下执行会发现 <code>(Registered)</code> 字样，这个时候还没有变成 <code>(Not Activated)</code>。继续往下单步步过。</p>
<p><img src="/xshell6_images/20200410110002949_29237.png" alt=""></p>
<p>这里就发现了一个长跳转，这个长跳转跳过了 <code>(Not Activated)</code> ，跳转上部是 <code>(Registered)</code> ，但这个跳转并未执行，那么就会到 <code>(Not Activated)</code> 赋值去。</p>
<pre><code>00F8F401 | FFB5 ACFBFFFF              | push dword ptr ss:[ebp-454]             |
00F8F407 | 8B9D 9CFBFFFF              | mov ebx,dword ptr ss:[ebp-464]          | [ebp-464]:&amp;L&quot;alee\r\nnature\r\nLicense Type: Xmanager Power Suite  (Registered)\r\nNumber of Licenses: 999\r\n\r\n&quot;
00F8F40D | FFB5 B8FBFFFF              | push dword ptr ss:[ebp-448]             |
00F8F413 | FFB5 A0FBFFFF              | push dword ptr ss:[ebp-460]             | [ebp-460]:L&quot;Number of Licenses: 999\r\n&quot;
00F8F419 | FFB5 B0FBFFFF              | push dword ptr ss:[ebp-450]             | [ebp-450]:L&quot;Xmanager Power Suite  (Registered)&quot;
00F8F41F | FFB5 A8FBFFFF              | push dword ptr ss:[ebp-458]             | [ebp-458]:L&quot;nature\r\n&quot;
00F8F425 | FFB5 A4FBFFFF              | push dword ptr ss:[ebp-45C]             | [ebp-45C]:L&quot;alee\r\n&quot;
00F8F42B | 68 00780501                | push xshell.1057800                     | 1057800:L&quot;%s%sLicense Type: %s\r\n%s%s\r\n%s&quot;
00F8F430 | 53                         | push ebx                                | ebx:&amp;L&quot;alee\r\nnature\r\nLicense Type: Xmanager Power Suite  (Registered)\r\nNumber of Licenses: 999\r\n\r\n&quot;
00F8F431 | FFD7                       | call edi                                |
00F8F433 | 83C4 20                    | add esp,20                              |
00F8F436 | FFD6                       | call esi                                |
00F8F438 | 8B40 04                    | mov eax,dword ptr ds:[eax+4]            |
00F8F43B | 83B8 2C010000 00           | cmp dword ptr ds:[eax+12C],0            |
00F8F442 | 75 12                      | jne xshell.F8F456                       |
00F8F444 | FFD6                       | call esi                                |
00F8F446 | 8B40 04                    | mov eax,dword ptr ds:[eax+4]            |
00F8F449 | 83B8 38010000 00           | cmp dword ptr ds:[eax+138],0            |
00F8F450 | 0F85 C2000000              | jne xshell.F8F518                       | 关键跳转
00F8F456 | 8D8D BCFBFFFF              | lea ecx,dword ptr ss:[ebp-444]          |
00F8F45C | FF15 7C050401              | call dword ptr ds:[&lt;&amp;Ordinal#316&gt;]      |
00F8F462 | 8D8D B4FBFFFF              | lea ecx,dword ptr ss:[ebp-44C]          |
00F8F468 | FF15 7C050401              | call dword ptr ds:[&lt;&amp;Ordinal#316&gt;]      |
00F8F46E | C645 FC 09                 | mov byte ptr ss:[ebp-4],9               | 9:'\t'
00F8F472 | FFD6                       | call esi                                |
00F8F474 | 8B40 04                    | mov eax,dword ptr ds:[eax+4]            |
00F8F477 | 83B8 2C010000 00           | cmp dword ptr ds:[eax+12C],0            |
00F8F47E | 74 38                      | je xshell.F8F4B8                        |
00F8F480 | FFD6                       | call esi                                |
00F8F482 | 8B40 04                    | mov eax,dword ptr ds:[eax+4]            |
00F8F485 | 8D8D BCFBFFFF              | lea ecx,dword ptr ss:[ebp-444]          |
00F8F48B | 83B8 30010000 01           | cmp dword ptr ds:[eax+130],1            |
00F8F492 | 75 12                      | jne xshell.F8F4A6                       |
00F8F494 | 68 40780501                | push xshell.1057840                     | 1057840:L&quot;(Activated Locally)&quot;
00F8F499 | FF15 88050401              | call dword ptr ds:[&lt;&amp;Ordinal#1516&gt;]     |
00F8F49F | 68 80780501                | push xshell.1057880                     | 1057880:L&quot;(Concurrent, Activated)&quot;
00F8F4A4 | EB 28                      | jmp xshell.F8F4CE                       |
00F8F4A6 | 68 68780501                | push xshell.1057868                     | 1057868:L&quot;(Activated)&quot;
00F8F4AB | FF15 88050401              | call dword ptr ds:[&lt;&amp;Ordinal#1516&gt;]     |
00F8F4B1 | 68 80780501                | push xshell.1057880                     | 1057880:L&quot;(Concurrent, Activated)&quot;
00F8F4B6 | EB 16                      | jmp xshell.F8F4CE                       |
00F8F4B8 | 68 B0780501                | push xshell.10578B0                     | 10578B0:L&quot;(Not Activated)&quot;
00F8F4BD | 8D8D BCFBFFFF              | lea ecx,dword ptr ss:[ebp-444]          |
00F8F4C3 | FF15 88050401              | call dword ptr ds:[&lt;&amp;Ordinal#1516&gt;]     |
00F8F4C9 | 68 D0780501                | push xshell.10578D0                     | 10578D0:L&quot;(Concurrent, Not Activated)&quot;
00F8F4CE | 8D8D B4FBFFFF              | lea ecx,dword ptr ss:[ebp-44C]          |
00F8F4D4 | FF15 88050401              | call dword ptr ds:[&lt;&amp;Ordinal#1516&gt;]     |
00F8F4DA | FFB5 BCFBFFFF              | push dword ptr ss:[ebp-444]             |
00F8F4E0 | 8BCB                       | mov ecx,ebx                             | ebx:&amp;L&quot;alee\r\nnature\r\nLicense Type: Xmanager Power Suite  (Registered)\r\nNumber of Licenses: 999\r\n\r\n&quot;
00F8F4E2 | 68 08790501                | push xshell.1057908                     | 1057908:L&quot;(Registered)&quot;
00F8F4E7 | FF15 84060401              | call dword ptr ds:[&lt;&amp;Ordinal#12595&gt;]    |
00F8F4ED | FFB5 B4FBFFFF              | push dword ptr ss:[ebp-44C]             |
00F8F4F3 | 8BCB                       | mov ecx,ebx                             | ebx:&amp;L&quot;alee\r\nnature\r\nLicense Type: Xmanager Power Suite  (Registered)\r\nNumber of Licenses: 999\r\n\r\n&quot;
00F8F4F5 | 68 24790501                | push xshell.1057924                     | 1057924:L&quot;(Concurrent Registered)&quot;
00F8F4FA | FF15 84060401              | call dword ptr ds:[&lt;&amp;Ordinal#12595&gt;]    |
00F8F500 | 8D8D B4FBFFFF              | lea ecx,dword ptr ss:[ebp-44C]          |
00F8F506 | FF15 78050401              | call dword ptr ds:[&lt;&amp;Ordinal#1039&gt;]     |
00F8F50C | 8D8D BCFBFFFF              | lea ecx,dword ptr ss:[ebp-444]          |
00F8F512 | FF15 78050401              | call dword ptr ds:[&lt;&amp;Ordinal#1039&gt;]     |
00F8F518 | 8D8D A8FBFFFF              | lea ecx,dword ptr ss:[ebp-458]          | [ebp-458]:L&quot;nature\r\n&quot;
</code></pre><p>观察上下文，跳转判断来自 <code>cmp dword ptr ds:[eax+12C],0</code>，这里下断，将数据地址修改为1，再运行得出如下结果：</p>
<p><img src="/xshell6_images/20200410111146785_7056.png" alt=""></p>
<p>那么在这里下一个硬件存取断点，重载程序，观察断下的位置：
第一处：这里看到了一大串置空操作，并没有类似判断函数加跳转这类操作，应该不是启动自检，更像是为自检提前准备空间，继续运行。</p>
<p><img src="/xshell6_images/20200410111917056_25006.png" alt=""></p>
<p>第二处：这里有一个 <code>NSACTIVATE_CheckOffline</code> 函数。字面意思很明显，离线检查，结果赋值给数据段，然后进行判断跳转。</p>
<p><img src="/xshell6_images/20200410112244071_20897.png" alt=""></p>
<p>修改数据值为1，然后运行程序</p>
<p><img src="/xshell6_images/20200410112637287_23746.png" alt=""></p>
<p>看来找对地方了。</p>
<h2 id="形成补丁">形成补丁<a href="#形成补丁" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>进入函数，寻找eax的最后赋值点，修改为1，即可。</p>
<p><img src="/xshell6_images/20200410113021956_27126.png" alt=""></p>
<p>从图中可以看到eax本来就是1，但是esi为0，这里将eax赋值为0了，最小化修改：</p>
<pre><code>10006DB5 | 8BC6                       | mov eax,esi                                        |
修改为：
10006DB5 | B0 01                      | mov al,1                                           |
</code></pre><p>直接nop掉也是可以的，看个人习惯。
<strong>保存补丁请注意补丁文件名为：<code>nsactivate.dll</code></strong></p>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://www.a1ee.cn/tags/crack">crack</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg></p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-12-28 14:08 &#43;0800</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://www.a1ee.cn/simaple/python_webdriver_selenium_info/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;</span><br><span>Python_webdriver_selenium_info</span>
			</a>
			<a class="prev-post" href="https://www.a1ee.cn/simaple/awvs/">
				<span class="post-nav-label">&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Awvs</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2021 <a href="https://www.a1ee.cn">alee</a></p>
	</footer>



	<script src="https://www.a1ee.cn/js/bundle.min.7d8545daa55d62427355498dd8da13f98ff79a7938ce7d2a5e2ae1ec0de3beb8.js" integrity="sha256-fYVF2qVdYkJzVUmN2NoT+Y/3mnk4zn0qXirh7A3jvrg=" crossorigin="anonymous"></script>
	

</body>

</html>
