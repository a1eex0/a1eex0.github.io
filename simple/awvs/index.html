<!DOCTYPE html>
<html lang="zh-cn">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="Awvs">
<meta itemprop="description" content="AWVS 12 下载 下载试用版（2020-05-12：下载链接已失效，需要邮箱重新注册） 准备工作 安装好后，登录并扫描网站，在事件窗口会看到相关信息： 所有"><meta itemprop="datePublished" content="2020-12-28T14:04:14+08:00" />
<meta itemprop="dateModified" content="2020-12-28T14:04:14+08:00" />
<meta itemprop="wordCount" content="2589"><meta itemprop="image" content="https://www.a1ee.cn/bg.png">
<meta itemprop="keywords" content="crack," /><meta property="og:title" content="Awvs" />
<meta property="og:description" content="AWVS 12 下载 下载试用版（2020-05-12：下载链接已失效，需要邮箱重新注册） 准备工作 安装好后，登录并扫描网站，在事件窗口会看到相关信息： 所有" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.a1ee.cn/simple/awvs/" /><meta property="og:image" content="https://www.a1ee.cn/bg.png" /><meta property="article:section" content="simple" />
<meta property="article:published_time" content="2020-12-28T14:04:14+08:00" />
<meta property="article:modified_time" content="2020-12-28T14:04:14+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.a1ee.cn/bg.png"/>

<meta name="twitter:title" content="Awvs"/>
<meta name="twitter:description" content="AWVS 12 下载 下载试用版（2020-05-12：下载链接已失效，需要邮箱重新注册） 准备工作 安装好后，登录并扫描网站，在事件窗口会看到相关信息： 所有"/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Awvs</title>
	<link rel="stylesheet" href="https://www.a1ee.cn/css/style.min.eac77496566fd7d5768fd650ddb0b2b181ca6a2d7c5fdd6fe6b8ba4bf47e566f.css" integrity="sha256-6sd0llZv19V2j9ZQ3bCysYHKai18X91v5ri6S/R+Vm8=" crossorigin="anonymous">
	<style>.bg-img {background-image: url('https://www.a1ee.cn/bg.png');}</style>
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.a1ee.cn">alee</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://www.a1ee.cn/basic/">BASIC</a>
				<a href="https://www.a1ee.cn/simple/">SIMPLE</a>
				<a href="https://www.a1ee.cn/medium/">MEDIUM</a>
				<a href="https://www.a1ee.cn/about-me/">ABOUT</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="img-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></button><span class="hdr-social hide-in-mobile"><a href="https://github.com/a1eex0" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.a1ee.cn/basic/">BASIC</a></li>
			<li><a href="https://www.a1ee.cn/simple/">SIMPLE</a></li>
			<li><a href="https://www.a1ee.cn/medium/">MEDIUM</a></li>
			<li><a href="https://www.a1ee.cn/about-me/">ABOUT</a></li>
		</ul>
	</div>


	<div class="bg-img"></div>
	<main class="site-main section-inner thin animated fadeIn faster">
		<h1>Awvs</h1>
		<div class="content">
			<h1 id="awvs-12">AWVS 12<a href="#awvs-12" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<h2 id="下载">下载<a href="#下载" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p><del>下载</del><a href="https://www.acunetix.com/download-8991-2/">试用版</a><strong>（2020-05-12：下载链接已失效，需要邮箱重新注册）</strong></p>
<p><img src="/awvs_images/20200326192517013_23500.png" alt="demo下载页"></p>
<h2 id="准备工作">准备工作<a href="#准备工作" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>安装好后，登录并扫描网站，在事件窗口会看到相关信息：</p>
<p><img src="/awvs_images/20200328112525480_3618.png" alt="本地路径"></p>
<p>所有的文件保存在本地的<code>file:///C:\\ProgramData\\Acunetix Trial\\shared\\scans\\2e0a7e18-0b84-4e2e-a85c-fc3358d06769.zip</code>压缩包下，切换到目录下，解压文件，可以看到三个文件：</p>
<p><img src="/awvs_images/20200328112741862_23809.png" alt="时间记录"></p>
<p>用sublime打开<code>logfile.csv</code>文件，可以查看到命令：</p>
<p><img src="/awvs_images/20200328113847789_8944.png" alt="日志文件"></p>
<p>观察上面的命令格式，可以提取命令，简化后的执行命令如下：</p>
<pre tabindex="0"><code>&quot;C:\Program Files (x86)\Acunetix Trial\12.0.190927120\wvsc.exe&quot; /scan https://www.baidu.com /log logfile.txt
</code></pre><p>以及日志部分的关键字提示符：</p>
<pre tabindex="0"><code>running in demo mode
</code></pre><h2 id="去掉-demo-版本的限制">去掉 demo 版本的限制<a href="#去掉-demo-版本的限制" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>以管理员权限运行x64dbg，打开<code>wvsc.exe</code>程序，然后更改命令为上面的简化命令：</p>
<p><img src="/awvs_images/20200328114558368_21397.png" alt="更改命令行"></p>
<p>然后运行至<code>EntryPoint</code>，搜索字符串 <code>running in demo mode</code>，在上面的切入点下断点：</p>
<p><img src="/awvs_images/20200328114851468_18485.png" alt="切入点"></p>
<p>找到当前目标地址值为1，但是需要它为0才能不显示 <code>running in demo mode</code>：</p>
<p><img src="/awvs_images/20200328115110925_19755.png" alt="目标地址"></p>
<p>查找一下 <code>[r13+8c8]</code>的引用：</p>
<p><img src="/awvs_images/20200328115608971_16757.png" alt="r13+8c8"></p>
<p>观察引用情况，数据段赋值操作有两条</p>
<pre tabindex="0"><code>00007FF7FBF5AB4B | 8886 C8080000            | mov byte ptr ds:[rsi+8C8],al            |
</code></pre><pre tabindex="0"><code>00007FF7FC34C670 | C683 C8080000 01         | mov byte ptr ds:[rbx+8C8],1             |
</code></pre><p>在两个地址下断，观察数据后，第一条 <code>al</code>中的值为0，第二条为赋值为1，因此找到关键点：</p>
<p><img src="/awvs_images/20200328120438467_6540.png" alt="关键点"></p>
<p>修改代码，将数据值赋值为0后，运行到切入点，发现跳过 <code>running in demo mode</code>：</p>
<p><img src="/awvs_images/20200328120328582_815.png" alt="成功"></p>
<p>查看扫描结果，是否存在请求信息：</p>
<p><img src="/awvs_images/20200328123615407_8616.png" alt="验证"></p>
<h2 id="去掉时间限制">去掉时间限制<a href="#去掉时间限制" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>修改本地时间，使其与北京时间不同，但请注意不要超过 <code>license_info.json</code>中的时间，不然会有报错！（后期测试加：第一次更换时间，可以使用， 但是我后来重新更换了时间，发现web页面会报错，提示 <code>too many request</code> 显然这是一个暗桩，但我并没有什么方式可以绕过，本地使用 <code>wvsc</code> 进行扫描时，并未报错，那么就有可能是存在另一个校验程序。）</p>
<p><img src="/awvs_images/20200328124023114_28591.png" alt="日志"></p>
<p>关键字符串：</p>
<pre tabindex="0"><code>system time moved back
</code></pre><p>搜索字符串，找到切入点：</p>
<p><img src="/awvs_images/20200328124559405_15029.png" alt="切入点"></p>
<p>进入函数下断，重载寻找 <code>al</code>的修改地址：</p>
<p><img src="/awvs_images/20200328124904432_16833.png" alt="修改点"></p>
<p>手动修改时发现，多次调用该函数进行判断，所以直接修改代码为 <code>xor rax,rax</code>：</p>
<p><img src="/awvs_images/20200328125113107_7665.png" alt="修改代码"></p>
<p>测试结果：</p>
<p><img src="/awvs_images/20200328125527330_30805.png" alt="破除时间限制"></p>
<h2 id="去除-license-覆写">去除 license 覆写<a href="#去除-license-覆写" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>功能 点上面已经破解的差不多了，接下来需要对 license 进行分析。</p>
<p><img src="/awvs_images/20200328132029724_4990.png" alt="license"></p>
<p>找到了一些关键字：</p>
<pre tabindex="0"><code>&quot;license_info.json&quot;
&quot;license_usage.json&quot;
&quot;license_info.json&quot;
&quot;license_usage.json&quot;
&quot;failed to write License Info File&quot;
</code></pre><p>在文件夹中搜索其中的字符串，</p>
<p><img src="/awvs_images/20200328132455963_7542.png" alt="license_info"></p>
<p>接下来，在 <code>failed to write License Info File</code>上方函数下断点。编辑 <code>license_info.json</code>，尝试是否会断下：</p>
<p><img src="/awvs_images/20200328133536146_7650.png" alt="疑似"></p>
<p>修改函数代码如下：</p>
<p><img src="/awvs_images/20200328134643347_14274.png" alt="函数修改"></p>
<p>修改 <code>license_info.json</code>内容并刷新页面，显示如下：</p>
<p><img src="/awvs_images/20200328134519469_28566.png" alt="覆写"></p>
<h2 id="生成-license">生成 license<a href="#生成-license" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>打开火绒剑，在不启动扫描的情况下，上一步的页面，看到<code>opsrv.exe</code>进程一直在调用<code>wvsc.exe</code></p>
<p><img src="/awvs_images/20200328135954027_17620.png" alt="判断调用"></p>
<p>猜测 <code>lincense</code> 的校验部分由该程序进行，将文件拖入x64dbg，进入到 <code>EntryPoint</code>，发现特征代码如下：</p>
<p><img src="/awvs_images/20200328141309673_2441.png" alt="OEP特征"></p>
<p>入口OEP属于是 <code>pyinstaller</code> 构建的exe程序的OEP特征，
这里用命令生成一个exe文件用来做对比，命令如下：</p>
<pre tabindex="0"><code>pyinstaller get_checksum.py
</code></pre><p><img src="/awvs_images/20200328141659389_25420.png" alt="oep"></p>
<p>还有一个特征方式可以鉴别：搜索字符串 <code>pyinstall</code> ：</p>
<p><img src="/awvs_images/20200328142355367_15431.png" alt="特征"></p>
<p>针对python打包的exe文件，可以使用 <code>pyinstxtractor + uncompyle6</code> 来进行反编译。
<code>pyinstxtractor.py</code> <a href="https://github.com/extremecoders-re/pyinstxtractor">github下载</a> ，然后使用如下命令，拆解 <code>exe</code>为 <code>pyc</code>：</p>
<pre tabindex="0"><code>python pyinstxtractor.py opsrv.exe
</code></pre><p>如果运行出现如下错误，请去<a href="https://sourceforge.net/projects/pyinstallerextractor/">sourceforge下载</a>，两个下载点下载的代码是不一样的，一个存在严格的版本校验，另一个则没有。</p>
<p><img src="/awvs_images/20200328142748577_19771.png" alt="报错截图"></p>
<p>失败与成功截图对比如下：</p>
<p><img src="/awvs_images/20200328144515070_6819.png" alt="对比"></p>
<p>在解压后的文件中，搜索 <code>license</code> 结果如下：</p>
<p><img src="/awvs_images/20200328144817268_30161.png" alt="licnese"></p>
<p>根据名字判断 <code>helpers.licensing.licenses.on_premise.pyc</code> 和 <code>helpers.licensing.licenses.pyc</code> 可能性比较大，逐个打开看看。
接下来用 <code>uncompyle6</code>反编译 <code>pyc</code>文件
首先使用命令安装（管理员权限）：</p>
<pre tabindex="0"><code>pip install uncompyle6
</code></pre><p>反编译命令如下：</p>
<pre tabindex="0"><code>uncompyle6 helpers.licensing.licenses.on_premise.pyc &gt;licenses.on_premise.py
</code></pre><p>寻找关键函数：</p>
<p><img src="/awvs_images/20200328145531512_3461.png" alt="checksum"></p>
<p>初步阅读代码，可以发现这是根据 <code>license_data</code>来拼凑一个字符串用来加密生成 <code>checksum</code> 文件，再与 <code>license_data</code> 中的 <code>checksum</code> 对比，如果不一样报错。 <code>license_data</code> 中的信息和 <code>license_info.json</code> 文件中的结构是一样的，估计是读取的这个文件，根据上下文定位判断函数内相关引用和调用来源：</p>
<p><img src="/awvs_images/20200328145841904_12385.png" alt="关键引用"></p>
<p>查看上面的引用来源:</p>
<p><img src="/awvs_images/20200328150021633_6360.png" alt="引用"></p>
<p>通过反编译两个 <code>pyc</code> 文件逐步获取加载 <code>license_data</code> 和生成 <code>checksum</code> 的 <code>md5</code> 算法，源代码最终结合的 <code>get_checksum.py</code> 代码如下：</p>
<pre tabindex="0"><code>&quot;&quot;&quot;
get_checksum (Supports AWVS 12)
Author : Alee
Date   : 28-Mar-2020
&quot;&quot;&quot;
import hashlib
import json

class ActivationErrorCodes:
    NO_WARNINGS = 0
    SITE_CHANGED = 1
    CHECKSUM_MISMATCH = 2
    INVALID_EXPIRY_DATES = 4
    EXPIRED = 8
    MAINTENANCE_EXPIRED = 16
    MAINTENANCE_WILL_EXPIRE = 32
    WITHIN_GRACE = 64
    MAC_CHANGED = 128
    KEY_NOT_FOUND = 256
    KEY_NOT_ENABLED = 512
    KEY_VERSION_MISMATCH = 1024
    ENGINE_COUNT_MISMATCH = 2048
    TARGET_COUNT_MISMATCH = 4096
    PRODUCT_CODE_NOT_FOUND = 8192
    SYSTEM_TIME_MOVED_BACK = 16384
    ERP_NOT_REACHED = 32768
    ERP_RESPONSE_ERROR = 65536
    CONCURRENT_REACT = 131072
    ACUMONITOR_FAILED = 16384
    ERROR_LOADING_ACTIVATION_JSON = 524288
    FILE_MISSING_OR_CORRUPT = 1048576

    @classmethod
    def get_keys(cls, code):
        result = []
        for key in cls.__dict__.keys():
            value = getattr(cls, key)
            if key[:1] != '_' and not callable(value) and value &amp; code:
                result.append(key)

        return result


def md5(value: str, salt: str=None) -&gt; str:
    m = hashlib.md5()
    if salt:
        m.update(salt.encode('utf-8'))
    m.update(value.encode('utf8'))
    return m.hexdigest()

def get_license_checksum(license_data):
    activation_error = license_data.get('activation_error', 0)
    if isinstance(activation_error, str):
        activation_error = int(activation_error)
    secret = '25128b0a92d51e6bf4ea7a40b91b33be911144f7'
    canonical_form = ''.join((
     secret,
     license_data.get('license_key', ''),
     license_data.get('product_code', ''),
     '%06d' % (license_data.get('max_targets', 0),),
     '%06d' % (license_data.get('max_engines', 0),),
     license_data.get('bxss_user_id', ''),
     license_data.get('bxss_api_key', ''),
     'true' if license_data.get('offline', False) else 'false',
     '%06d' % (license_data.get('major_version', 0),),
     '%06d' % (license_data.get('minor_version', 0),),
     '%06d' % (license_data.get('build_number', 0),),
     'true' if license_data.get('expired') else 'false',
     'true' if license_data.get('maintenance_expired') else 'false',
     '%06d' % (activation_error,),
     'true' if license_data.get('activated') else 'false',
     'true' if license_data.get('scan') else 'false',
     'true' if license_data.get('update') else 'false',
     'true' if license_data.get('access') else 'false',
     '%d' % (license_data.get('grace', 0),)))
    checksum = md5(canonical_form)
    print('canonical_form:'+canonical_form)
    print('checksum:'+checksum)
    print('license_data.get(\'checksum\'):'+license_data.get('checksum'))

def get_license():
    jsonPath = './license_info.json'
    license_info = json.loads(open(jsonPath, 'rt', encoding='utf-8').read())
    license_info = dict(license_info)
    info = license_info.get('info')
    if info is not None:
        if isinstance(info, dict):
            del license_info['info']
            license_info.update(info)
    license_info['offline'] = license_info.get('is_offline', False)
    license_info['activation_error_codes'] = ActivationErrorCodes.get_keys(int(license_info.get('activation_error', '0')))
    return license_info
license_data = get_license()
get_license_checksum(license_data)
</code></pre><p>代码存在很大的优化空间。
下面给出 <code>license_info.json</code> 文件的模板，其中 <code>AOPENT</code>为企业版标识，请不要修改。其他的内容，可以根据上方算法进行修改。</p>
<pre tabindex="0"><code>{
 &quot;info&quot;: {
  &quot;license_key&quot;: &quot;TRY-TO-CRAKED-ALEE&quot;,
  &quot;company&quot;: &quot;REVERSE&quot;,
  &quot;name&quot;: &quot;ALEE&quot;,
  &quot;phone&quot;: &quot;666666&quot;,
  &quot;email&quot;: &quot;crake@crake.com&quot;,
  &quot;country&quot;: &quot;earth&quot;,
  &quot;first_activated&quot;: &quot;2020-01-17T10:53:50&quot;,
  &quot;expires&quot;: &quot;2100-01-31T10:53:50&quot;,
  &quot;maintenance_expires&quot;: &quot;2100-01-31T10:53:50&quot;,
  &quot;max_engines&quot;: 999999,
  &quot;max_targets&quot;: 999999,
  &quot;product_code&quot;: &quot;AOPENT&quot;,
  &quot;bxss_user_id&quot;: &quot;&quot;,
  &quot;bxss_api_key&quot;: &quot;&quot;,
  &quot;is_offline&quot;: false,
  &quot;is_worker&quot;: false
 },
 &quot;major_version&quot;: 12,
 &quot;minor_version&quot;: 0,
 &quot;build_number&quot;: 190927120,
 &quot;expired&quot;: false,
 &quot;maintenance_expired&quot;: false,
 &quot;scan&quot;: true,
 &quot;update&quot;: true,
 &quot;access&quot;: true,
 &quot;activation_error&quot;: 0,
 &quot;activated&quot;: true,
 &quot;checksum&quot;: &quot;17721cb9bc44780a55f52aedde975737&quot;,
 &quot;grace&quot;: -1,
 &quot;last_reactivated&quot;: &quot;2020-01-31T10:53:50&quot;
}
</code></pre><p>请将 <code>get_checksum.py</code> 和 <code>license_info.json</code> 放在同一文件夹下！运行结果如下：</p>
<p><img src="/awvs_images/20200328151700771_29132.png" alt="运行结果"></p>
<h2 id="验收阶段">验收阶段<a href="#验收阶段" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>结束</p>
<p><img src="/awvs_images/20200328151903223_21711.png" alt="验收"></p>
<h1 id="awvs-13">AWVS 13<a href="#awvs-13" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
2020-05-13                新增AWVS13专业版权限绕过方式
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p>
<h2 id="来源">来源<a href="#来源" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>安装包来源于同事，同事来源与互联网，版本：13.0.200205121</p>
<h2 id="准备工作-1">准备工作<a href="#准备工作-1" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>调试命令：</p>
<pre tabindex="0"><code>&quot;C:\Program Files (x86)\Acunetix\13.0.200205121\wvsc.exe&quot; /scan https://www.baidu.com /profile Default /log C:\Users\Alee\Desktop\logfile.txt
</code></pre><p>尝试过不加 <code>/profile Default</code> 不会正常进行扫描任务。</p>
<h2 id="去掉license覆写">去掉license覆写<a href="#去掉license覆写" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>运行任务，报错信息返回在指定的日志文件中，信息如下：</p>
<pre tabindex="0"><code>2020-05-13T10:49:41.218516	INFO	MAIN	8952	command line &quot;C:\Program Files (x86)\Acunetix\13.0.200205121\wvsc.exe&quot; /scan https://www.baidu.com /profile Default /log C:\Users\Alee\Desktop\logfile.txt
2020-05-13T10:55:37.513990	ERROR	activator	8952	Error: License File could not be loaded
2020-05-13T10:55:39.435225	ERROR	MAIN	8952	Licensing Error
2020-05-13T10:55:39.436958	INFO	MAIN	8952	application exiting
</code></pre><p>在x64dbg中搜搜当前区域字符串引用 <code>License File could not be loaded</code>、<code>Licensing Error</code> 总共三处</p>
<p><img src="/awvs_images/20200513110543748_9642.png" alt=""></p>
<p>观察license文件，提示 <code>Licensing Error</code>时，文件就会被重写。</p>
<p><img src="/awvs_images/20200513110519912_1695.png" alt=""></p>
<p>配合搜索当前区域的字符串 <code>failed to write License Info File</code></p>
<p><img src="/awvs_images/20200513110917251_6450.png" alt=""></p>
<p><img src="/awvs_images/20200513111026290_22480.png" alt=""></p>
<p>定位到 <code>call 0x00007FF79A429B70</code> 就是重写函数。
将定位函数的代码重写为</p>
<pre tabindex="0"><code>mov eax,1
ret
</code></pre><h2 id="一石二鸟">一石二鸟<a href="#一石二鸟" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>重写函数处理掉以后，就是第一条<code>License File could not be loaded</code>，搜索字符串下断，重新回到<code>Licensing Error</code>提示的上下文片段，发现了一个有趣的地方：</p>
<p><img src="/awvs_images/20200521101233740_13201.png" alt=""></p>
<p>上方的条件call，竟然包含了<code>License File could not be loaded</code>的报错，还包含了很多的报错信息<code>could not decode / decrypt license data</code>
可以推测就是证书校验函数了，重写尝试：</p>
<pre tabindex="0"><code>mov eax,1
ret
</code></pre><p>居然正常运行了，看来把鸡蛋放在一个篮子里，还是挺好的。</p>
<h2 id="license改动">license改动<a href="#license改动" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>license的算法并未修改，不过需要修改一些版本地址之类的地方，提供一份可用license：</p>
<pre tabindex="0"><code>{
 &quot;info&quot;: {
  &quot;license_key&quot;: &quot;TRY-TO-CRAKED-ALEE&quot;,
  &quot;company&quot;: &quot;REVERSE&quot;,
  &quot;name&quot;: &quot;ALEE&quot;,
  &quot;phone&quot;: &quot;666666&quot;,
  &quot;email&quot;: &quot;crake@crake.com&quot;,
  &quot;country&quot;: &quot;earth&quot;,
  &quot;first_activated&quot;: &quot;2020-05-13T10:53:50&quot;,
  &quot;expires&quot;: &quot;2100-05-13T10:53:50&quot;,
  &quot;maintenance_expires&quot;: &quot;2100-05-13T10:53:50&quot;,
  &quot;max_engines&quot;: 999999,
  &quot;max_targets&quot;: 999999,
  &quot;product_code&quot;: &quot;AOPENT&quot;,
  &quot;bxss_user_id&quot;: &quot;&quot;,
  &quot;bxss_api_key&quot;: &quot;&quot;,
  &quot;is_offline&quot;: false,
  &quot;is_worker&quot;: false
 },
 &quot;major_version&quot;: 13,
 &quot;minor_version&quot;: 0,
 &quot;build_number&quot;: 200205121,
 &quot;expired&quot;: false,
 &quot;maintenance_expired&quot;: false,
 &quot;scan&quot;: true,
 &quot;update&quot;: true,
 &quot;access&quot;: true,
 &quot;activation_error&quot;: 0,
 &quot;activated&quot;: true,
 &quot;checksum&quot;: &quot;31baf19e58d82c2c9f166371cc593a21&quot;,
 &quot;grace&quot;: -1,
 &quot;last_reactivated&quot;: &quot;2020-05-13T10:53:50&quot;
}
</code></pre><h2 id="结语">结语<a href="#结语" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>没想到13不仅仅是丰富了漏洞库，优化了扫描界面，就连<code>注册</code>也更加方便了。</p>

		</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2022 <a href="https://www.a1ee.cn">alee</a></p>
	</footer>



	<script src="https://www.a1ee.cn/js/bundle.min.7d8545daa55d62427355498dd8da13f98ff79a7938ce7d2a5e2ae1ec0de3beb8.js" integrity="sha256-fYVF2qVdYkJzVUmN2NoT+Y/3mnk4zn0qXirh7A3jvrg=" crossorigin="anonymous"></script>
	

</body>

</html>
